def generate_hospital_certificate_pdf(hospital):
    """
    Generate a PDF certificate for hospital approval with elegant professional design

    Args:
        hospital: Hospital model instance

    Returns:
        BytesIO: PDF file in memory, or None if generation fails
    """
    try:
        # Create elegant certificate HTML template with beautiful cursive design
        certificate_html = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHB Hospital Certificate of Approval</title>
    <style>
        @page {{
            size: A4 landscape;
            margin: 0;
        }}
        body {{
            font-family: Georgia, 'Times New Roman', serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
        }}
        .certificate-container {{
            width: 1000px;
            height: 700px;
            background-color: #fdfaf7;
            border: 10px solid #1a5c3a;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
            box-sizing: border-box;
        }}
        .background-lines {{
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            opacity: 0.4;
            z-index: 0;
        }}
        .background-lines::before {{
            content: '';
            position: absolute;
            top: -20%;
            left: -20%;
            width: 140%;
            height: 140%;
            background:
                radial-gradient(circle at 10% 80%, transparent 40%, #d4e8dc 41%, transparent 42%),
                radial-gradient(circle at 90% 20%, transparent 40%, #d4e8dc 41%, transparent 42%);
            background-size: 50% 50%;
            transform: rotate(-15deg);
        }}
        .background-lines::after {{
            content: '';
            position: absolute;
            top: -20%;
            left: -20%;
            width: 140%;
            height: 140%;
            background:
                radial-gradient(circle at 20% 70%, transparent 40%, #d4e8dc 41%, transparent 42%),
                radial-gradient(circle at 80% 30%, transparent 40%, #d4e8dc 41%, transparent 42%);
            background-size: 50% 50%;
            transform: rotate(5deg);
        }}
        .content {{
            position: relative;
            z-index: 1;
            width: 100%;
        }}
        .org-header {{
            font-family: Georgia, serif;
            font-size: 13px;
            color: #1a5c3a;
            margin-bottom: 15px;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: bold;
        }}
        .title {{
            font-family: 'Brush Script MT', cursive, Georgia, serif;
            font-size: 100px;
            color: #1a5c3a;
            margin-bottom: 5px;
            line-height: 1;
        }}
        .subtitle {{
            font-family: Georgia, serif;
            font-size: 20px;
            color: #666;
            margin-bottom: 40px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }}
        .proudly-presented {{
            font-family: Georgia, serif;
            font-size: 16px;
            color: #555;
            margin-bottom: 10px;
        }}
        .name {{
            font-family: 'Brush Script MT', cursive, Georgia, serif;
            font-size: 60px;
            color: #1a5c3a;
            margin-bottom: 20px;
            border-bottom: 1px solid #888;
            padding-bottom: 5px;
            display: inline-block;
            max-width: 85%;
        }}
        .course-description {{
            font-family: Georgia, serif;
            font-size: 15px;
            color: #555;
            margin-bottom: 60px;
            max-width: 750px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }}
        .signatures {{
            display: flex;
            justify-content: space-around;
            width: 90%;
            margin: 50px auto 0 auto;
            position: relative;
        }}
        .signature-block {{
            flex: 1;
            text-align: center;
            padding: 0 20px;
        }}
        .signature-line {{
            border-bottom: 1px solid #888;
            width: 70%;
            margin: 0 auto 5px auto;
        }}
        .signer-name {{
            font-family: Georgia, serif;
            font-size: 14px;
            color: #444;
            font-weight: 500;
        }}
        .signer-title {{
            font-family: Georgia, serif;
            font-size: 12px;
            color: #777;
        }}
        .seal {{
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 2px dashed #1a5c3a;
            background-color: #e8f3ed;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Georgia, serif;
            font-size: 11px;
            color: #1a5c3a;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.2;
            padding: 10px;
            box-sizing: border-box;
            z-index: 1;
            transform: translate(-50%, -50%) rotate(-15deg);
            margin-top: 120px;
            font-weight: bold;
        }}
        .seal-text {{
            transform: rotate(15deg);
            text-align: center;
        }}
        .cert-number {{
            position: absolute;
            bottom: 25px;
            right: 40px;
            font-size: 9px;
            color: #999;
            text-align: right;
            font-family: Georgia, serif;
        }}
    </style>
</head>
<body>
    <div class="certificate-container">
        <div class="background-lines"></div>

        <div class="content">
            <p class="org-header">Public Health Bureau - Federal Republic of Nigeria</p>
            <h1 class="title">Certificate</h1>
            <p class="subtitle">OF APPROVAL</p>

            <p class="proudly-presented">proudly presented to</p>
            <p class="name">{hospital.name}</p>
            <p class="course-description">
                In recognition of successfully completing the comprehensive registration and verification
                process with the Public Health Bureau (PHB). This hospital has met all required standards
                and is hereby authorized as a verified member of the PHB Healthcare Network, with full
                access to the Electronic Health Records System, Electronic Prescription Service, and all
                integrated healthcare platform services.
            </p>

            <div class="signatures">
                <div class="signature-block">
                    <div class="signature-line"></div>
                    <p class="signer-name">PHB ADMINISTRATION</p>
                    <p class="signer-title">authorized signature</p>
                </div>

                <div class="seal">
                    <span class="seal-text">VERIFIED<br>&amp;<br>APPROVED</span>
                </div>

                <div class="signature-block">
                    <div class="signature-line"></div>
                    <p class="signer-name">{timezone.now().strftime('%d %B %Y').upper()}</p>
                    <p class="signer-title">date of issue</p>
                </div>
            </div>

            <div class="cert-number">
                Certificate ID: PHB-CERT-{hospital.id:04d}-{timezone.now().strftime('%Y%m%d')}<br/>
                Registration: {hospital.registration_number} | Location: {hospital.city}, {hospital.state}<br/>
                Verify at: https://phb.ng/verify/{hospital.registration_number}
            </div>
        </div>
    </div>
</body>
</html>
"""

        # Generate PDF
        pdf_buffer = BytesIO()
        pisa_status = pisa.CreatePDF(
            certificate_html,
            dest=pdf_buffer
        )

        if pisa_status.err:
            logger.error(f"PDF generation failed for hospital {hospital.name}")
            return None

        pdf_buffer.seek(0)
        logger.info(f"✅ PDF certificate generated for {hospital.name}")
        return pdf_buffer

    except Exception as e:
        logger.error(f"❌ Failed to generate PDF certificate: {str(e)}")
        return None
