{% extends "email/base_email.html" %}

{% block content %}
<div class="email-container">
    <div class="header">
        <h1>Prescription Approved ‚úÖ</h1>
    </div>

    <div class="content">
        <p>Hello {{ patient_name }},</p>

        <p>Great news! Your prescription request has been approved by {{ doctor_name }}.</p>

        <div class="approval-summary">
            <h3>Prescription Details</h3>
            <div class="detail-row">
                <span class="label">Reference Number:</span>
                <span class="value">{{ request_reference }}</span>
            </div>
            <div class="detail-row">
                <span class="label">Approval Date:</span>
                <span class="value">{{ approval_date }}</span>
            </div>
            <div class="detail-row">
                <span class="label">Prescriber:</span>
                <span class="value">{{ doctor_name }}</span>
            </div>
        </div>

        <div class="medications-list">
            <h3>Approved Medications</h3>
            <table class="medication-table">
                <thead>
                    <tr>
                        <th>Medication</th>
                        <th>Quantity</th>
                        <th>Dosage Instructions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for medication in medications %}
                    <tr>
                        <td>
                            <strong>{{ medication.name }}</strong><br>
                            <small>{{ medication.strength }} - {{ medication.form }}</small>
                        </td>
                        <td>{{ medication.quantity }}</td>
                        <td>{{ medication.dosage_instructions }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if clinical_notes %}
        <div class="clinical-notes">
            <h3>Clinical Notes from Your Prescriber</h3>
            <p>"{{ clinical_notes }}"</p>
        </div>
        {% endif %}

        <div class="collection-info">
            <h3>Collection Information üè•</h3>
            <p>Your prescription has been sent electronically to your nominated pharmacy:</p>
            <p class="pharmacy-name"><strong>{{ pharmacy_name }}</strong></p>
            <p>{{ pharmacy_address }}</p>

            <div class="timeline-box">
                <h4>üìÖ Collection Timeline</h4>
                <p>Your prescription should be ready for collection within:</p>
                <ul>
                    <li><strong>2-3 business days</strong> for most medications</li>
                    <li><strong>Up to 5 business days</strong> for special orders</li>
                </ul>
                <p>You will receive another email when your prescription is ready for pickup.</p>
            </div>

            <p class="pickup-deadline"><strong>Please collect by: {{ pickup_deadline }}</strong></p>
        </div>

        <div class="important-instructions">
            <h3>Important Instructions üìã</h3>
            <ul>
                <li><strong>Bring ID:</strong> You'll need to show valid identification when collecting</li>
                <li><strong>Pharmacy Hours:</strong> Check your pharmacy's opening hours before visiting</li>
                <li><strong>Payment:</strong> Some prescriptions may require payment (your pharmacy will advise)</li>
                <li><strong>Questions:</strong> The pharmacy team can answer questions about your medication</li>
                <li><strong>Storage:</strong> Follow the storage instructions provided with your medication</li>
            </ul>
        </div>

        {% if has_refills %}
        <div class="refill-info">
            <h3>Repeat Prescriptions üîÑ</h3>
            <p>Some of your medications have been approved for repeat prescriptions:</p>
            <ul>
                {% for medication in medications %}
                {% if medication.refills_allowed > 0 %}
                <li><strong>{{ medication.name }}</strong> - {{ medication.refills_allowed }} refill(s) authorized</li>
                {% endif %}
                {% endfor %}
            </ul>
            <p>You can request refills through your account when needed.</p>
        </div>
        {% endif %}

        <div class="safety-reminder">
            <h3>‚ö†Ô∏è Safety Reminders</h3>
            <ul>
                <li>Always read the patient information leaflet before taking your medication</li>
                <li>Take medications exactly as prescribed</li>
                <li>Report any side effects to your doctor or pharmacist</li>
                <li>Keep medications out of reach of children</li>
                <li>Do not share your medication with others</li>
            </ul>
        </div>

        <div class="footer-note">
            <p>If you have any questions about your prescription, please contact your GP practice or pharmacy.</p>
            <p>Thank you for using PHB Healthcare! ü©∫</p>
        </div>
    </div>
</div>

<style>
    .email-container {
        max-width: 600px;
        margin: 0 auto;
        font-family: Arial, sans-serif;
    }

    .header {
        background-color: #4caf50;
        color: white;
        padding: 20px;
        text-align: center;
        border-radius: 5px 5px 0 0;
    }

    .header h1 {
        color: white;
        margin: 0;
    }

    .content {
        padding: 20px;
        background-color: #ffffff;
        border-radius: 0 0 5px 5px;
    }

    .approval-summary {
        background-color: #e8f5e9;
        padding: 20px;
        border-radius: 5px;
        margin: 20px 0;
        border-left: 4px solid #4caf50;
    }

    .approval-summary h3 {
        margin-top: 0;
        color: #2e7d32;
    }

    .detail-row {
        margin: 10px 0;
        display: flex;
        justify-content: space-between;
    }

    .label {
        font-weight: bold;
        color: #666;
    }

    .value {
        color: #333;
    }

    .medications-list {
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
    }

    .medications-list h3 {
        margin-top: 0;
        color: #424242;
    }

    .medication-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        background-color: white;
    }

    .medication-table th {
        background-color: #4caf50;
        color: white;
        padding: 10px;
        text-align: left;
        font-weight: bold;
    }

    .medication-table td {
        padding: 10px;
        border-bottom: 1px solid #e0e0e0;
    }

    .clinical-notes {
        background-color: #e3f2fd;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
        border-left: 3px solid #2196f3;
    }

    .clinical-notes h3 {
        margin-top: 0;
        color: #1976d2;
    }

    .clinical-notes p {
        font-style: italic;
        color: #424242;
    }

    .collection-info {
        background-color: #fff3e0;
        padding: 20px;
        border-radius: 5px;
        margin: 20px 0;
        border-left: 4px solid #ff9800;
    }

    .collection-info h3 {
        margin-top: 0;
        color: #e65100;
    }

    .pharmacy-name {
        font-size: 18px;
        color: #e65100;
        margin: 10px 0;
    }

    .timeline-box {
        background-color: white;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
    }

    .timeline-box h4 {
        margin-top: 0;
        color: #f57c00;
    }

    .timeline-box ul {
        margin: 10px 0;
        padding-left: 20px;
    }

    .pickup-deadline {
        background-color: #fff9c4;
        padding: 10px;
        border-radius: 3px;
        text-align: center;
        margin-top: 15px;
        font-size: 16px;
        color: #f57f17;
    }

    .important-instructions {
        background-color: #e1f5fe;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
    }

    .important-instructions h3 {
        margin-top: 0;
        color: #01579b;
    }

    .important-instructions ul {
        margin: 10px 0;
        padding-left: 20px;
    }

    .refill-info {
        background-color: #f3e5f5;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
    }

    .refill-info h3 {
        margin-top: 0;
        color: #6a1b9a;
    }

    .refill-info ul {
        margin: 10px 0;
        padding-left: 20px;
    }

    .safety-reminder {
        background-color: #ffebee;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
        border-left: 4px solid #f44336;
    }

    .safety-reminder h3 {
        margin-top: 0;
        color: #c62828;
    }

    .safety-reminder ul {
        margin: 10px 0;
        padding-left: 20px;
    }

    .footer-note {
        border-top: 1px solid #eee;
        margin-top: 20px;
        padding-top: 20px;
        color: #666;
        text-align: center;
    }
</style>
{% endblock %}
