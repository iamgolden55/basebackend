# Generated by Django 5.0.1 on 2025-06-28 09:17

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('api', '0028_rename_api_clinica_organiz_a4a6c3_idx_api_clinica_organiz_de13cc_idx_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='HealthcareAuthority',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Official name of the healthcare authority', max_length=200, unique=True)),
                ('short_name', models.CharField(blank=True, help_text='Abbreviated name or acronym', max_length=50)),
                ('authority_code', models.CharField(blank=True, help_text='Unique identifier code', max_length=20, unique=True)),
                ('authority_type', models.CharField(choices=[('federal', 'Federal Government'), ('state', 'State/Provincial Government'), ('regional', 'Regional Authority'), ('local', 'Local Government'), ('international', 'International Organization'), ('professional', 'Professional Association')], default='federal', max_length=20)),
                ('jurisdiction_level', models.CharField(choices=[('national', 'National'), ('state', 'State/Province'), ('county', 'County/District'), ('city', 'City/Municipal'), ('regional', 'Regional'), ('international', 'International')], default='national', max_length=20)),
                ('country', models.CharField(help_text='Country where authority has jurisdiction', max_length=100)),
                ('state_province', models.CharField(blank=True, help_text='State or province (if applicable)', max_length=100)),
                ('regions_covered', models.JSONField(default=list, help_text='List of regions/areas under jurisdiction')),
                ('official_address', models.TextField(help_text='Official headquarters address')),
                ('phone_number', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, help_text='Official contact email', max_length=254)),
                ('website', models.URLField(blank=True, help_text='Official website URL')),
                ('licensing_portal_url', models.URLField(blank=True, help_text='URL for healthcare provider licensing portal')),
                ('renewal_portal_url', models.URLField(blank=True, help_text='URL for license renewal')),
                ('verification_portal_url', models.URLField(blank=True, help_text='URL for verifying licenses')),
                ('regulatory_framework', models.TextField(blank=True, help_text='Description of regulatory framework')),
                ('license_types_issued', models.JSONField(default=list, help_text='Types of licenses this authority issues')),
                ('inspection_frequency', models.CharField(blank=True, help_text='How often inspections are conducted', max_length=50)),
                ('compliance_requirements', models.TextField(blank=True, help_text='Key compliance requirements')),
                ('application_processing_days', models.PositiveIntegerField(blank=True, help_text='Average days to process applications', null=True)),
                ('renewal_processing_days', models.PositiveIntegerField(blank=True, help_text='Average days to process renewals', null=True)),
                ('inspection_scheduling_days', models.PositiveIntegerField(blank=True, help_text='Days advance notice for inspections', null=True)),
                ('standard_license_fee', models.DecimalField(blank=True, decimal_places=2, help_text='Standard licensing fee', max_digits=10, null=True)),
                ('renewal_fee', models.DecimalField(blank=True, decimal_places=2, help_text='License renewal fee', max_digits=10, null=True)),
                ('inspection_fee', models.DecimalField(blank=True, decimal_places=2, help_text='Inspection fee (if applicable)', max_digits=10, null=True)),
                ('currency', models.CharField(default='USD', help_text='Currency for fees', max_length=3)),
                ('primary_contact_name', models.CharField(blank=True, help_text='Primary contact person', max_length=100)),
                ('primary_contact_title', models.CharField(blank=True, help_text='Title of primary contact', max_length=100)),
                ('primary_contact_phone', models.CharField(blank=True, max_length=20)),
                ('primary_contact_email', models.EmailField(blank=True, max_length=254)),
                ('licensing_officer_name', models.CharField(blank=True, help_text='Chief licensing officer', max_length=100)),
                ('licensing_officer_email', models.EmailField(blank=True, max_length=254)),
                ('licensing_officer_phone', models.CharField(blank=True, max_length=20)),
                ('business_hours', models.TextField(blank=True, help_text='Official business hours')),
                ('languages_supported', models.JSONField(default=list, help_text='Languages supported for applications')),
                ('emergency_contact_available', models.BooleanField(default=False, help_text='Whether emergency contact is available')),
                ('has_api_integration', models.BooleanField(default=False, help_text='Whether authority provides API access')),
                ('api_documentation_url', models.URLField(blank=True, help_text='URL to API documentation')),
                ('supports_electronic_submission', models.BooleanField(default=False, help_text='Whether electronic submissions are accepted')),
                ('digital_signature_accepted', models.BooleanField(default=False, help_text='Whether digital signatures are accepted')),
                ('response_time_hours', models.PositiveIntegerField(blank=True, help_text='Typical response time for inquiries in hours', null=True)),
                ('system_uptime_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='System uptime percentage', max_digits=5, null=True)),
                ('last_system_outage', models.DateTimeField(blank=True, help_text='Last reported system outage', null=True)),
                ('transparency_score', models.PositiveIntegerField(blank=True, help_text='Transparency score (1-10)', null=True)),
                ('efficiency_rating', models.PositiveIntegerField(blank=True, help_text='Efficiency rating (1-10)', null=True)),
                ('customer_satisfaction_score', models.DecimalField(blank=True, decimal_places=1, help_text='Customer satisfaction score (1-10)', max_digits=3, null=True)),
                ('is_active', models.BooleanField(default=True, help_text='Whether authority is currently active')),
                ('last_verified', models.DateField(blank=True, help_text='Last time information was verified', null=True)),
                ('verification_source', models.CharField(blank=True, help_text='Source of last verification', max_length=200)),
                ('special_programs', models.TextField(blank=True, help_text='Special licensing programs or initiatives')),
                ('enforcement_actions', models.TextField(blank=True, help_text='Recent enforcement actions or policy changes')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the authority')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_healthcare_authorities', to=settings.AUTH_USER_MODEL)),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='modified_healthcare_authorities', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name_plural': 'Healthcare Authorities',
                'ordering': ['country', 'name'],
                'permissions': [('can_manage_authorities', 'Can manage healthcare authorities'), ('can_verify_authority_data', 'Can verify authority information'), ('can_view_performance_metrics', 'Can view authority performance metrics')],
            },
        ),
        migrations.CreateModel(
            name='HospitalLicense',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('license_number', models.CharField(help_text='Official license number', max_length=100)),
                ('license_type', models.CharField(choices=[('operating', 'Operating License'), ('emergency', 'Emergency Services License'), ('surgical', 'Surgical Services License'), ('maternity', 'Maternity Services License'), ('icu', 'ICU/Critical Care License'), ('psychiatric', 'Psychiatric Services License'), ('pediatric', 'Pediatric Services License'), ('radiology', 'Radiology/Imaging License'), ('laboratory', 'Laboratory Services License'), ('pharmacy', 'Hospital Pharmacy License'), ('blood_bank', 'Blood Bank License'), ('ambulance', 'Ambulance Services License'), ('research', 'Medical Research License'), ('teaching', 'Teaching Hospital License'), ('specialty', 'Specialty Services License'), ('other', 'Other License Type')], default='operating', max_length=30)),
                ('license_category', models.CharField(blank=True, help_text='Specific category or classification', max_length=100)),
                ('license_name', models.CharField(help_text='Official name of the license', max_length=200)),
                ('license_status', models.CharField(choices=[('active', 'Active'), ('expired', 'Expired'), ('suspended', 'Suspended'), ('revoked', 'Revoked'), ('pending', 'Pending Approval'), ('renewal_pending', 'Renewal Pending'), ('under_review', 'Under Review')], default='active', max_length=20)),
                ('issue_date', models.DateField(help_text='Date license was issued')),
                ('effective_date', models.DateField(help_text='Date license becomes effective')),
                ('expiration_date', models.DateField(blank=True, help_text='License expiration date (if applicable)', null=True)),
                ('renewal_status', models.CharField(choices=[('current', 'Current'), ('due_soon', 'Due Soon'), ('overdue', 'Overdue'), ('in_process', 'Renewal in Process'), ('not_applicable', 'Not Applicable')], default='current', max_length=20)),
                ('last_renewal_date', models.DateField(blank=True, help_text='Date of last renewal', null=True)),
                ('next_renewal_due', models.DateField(blank=True, help_text='Date when next renewal is due', null=True)),
                ('renewal_frequency_months', models.PositiveIntegerField(blank=True, help_text='Renewal frequency in months', null=True)),
                ('conditions', models.TextField(blank=True, help_text='Conditions or restrictions on the license')),
                ('limitations', models.TextField(blank=True, help_text='Any limitations specified in the license')),
                ('bed_capacity_authorized', models.PositiveIntegerField(blank=True, help_text='Authorized bed capacity (if specified)', null=True)),
                ('services_authorized', models.JSONField(default=list, help_text='List of authorized services')),
                ('last_inspection_date', models.DateField(blank=True, help_text='Date of last regulatory inspection', null=True)),
                ('next_inspection_due', models.DateField(blank=True, help_text='Date when next inspection is due', null=True)),
                ('inspection_frequency_months', models.PositiveIntegerField(blank=True, help_text='Inspection frequency in months', null=True)),
                ('compliance_score', models.PositiveIntegerField(blank=True, help_text='Latest compliance score (1-100)', null=True)),
                ('license_fee_paid', models.DecimalField(blank=True, decimal_places=2, help_text='License fee paid', max_digits=10, null=True)),
                ('renewal_fee', models.DecimalField(blank=True, decimal_places=2, help_text='Renewal fee amount', max_digits=10, null=True)),
                ('currency', models.CharField(default='USD', help_text='Currency for fees', max_length=3)),
                ('application_date', models.DateField(blank=True, help_text='Date application was submitted', null=True)),
                ('processing_days', models.PositiveIntegerField(blank=True, help_text='Days taken to process application', null=True)),
                ('application_reference', models.CharField(blank=True, help_text='Application reference number', max_length=100)),
                ('license_officer_name', models.CharField(blank=True, help_text='Name of assigned license officer', max_length=100)),
                ('license_officer_email', models.EmailField(blank=True, help_text='Email of license officer', max_length=254)),
                ('license_officer_phone', models.CharField(blank=True, help_text='Phone of license officer', max_length=20)),
                ('license_certificate', models.FileField(blank=True, help_text='Digital copy of license certificate', null=True, upload_to='licenses/certificates/')),
                ('supporting_documents', models.JSONField(default=list, help_text='List of supporting documents')),
                ('inspection_reports', models.JSONField(default=list, help_text='List of inspection reports')),
                ('verification_url', models.URLField(blank=True, help_text='URL to verify license online')),
                ('public_verification_code', models.CharField(blank=True, help_text='Public verification code', max_length=50)),
                ('last_verified', models.DateTimeField(blank=True, help_text='Last time license was verified', null=True)),
                ('auto_verification_enabled', models.BooleanField(default=False, help_text='Whether automatic verification is enabled')),
                ('expiry_alert_sent', models.BooleanField(default=False, help_text='Whether expiry alert has been sent')),
                ('renewal_alert_sent', models.BooleanField(default=False, help_text='Whether renewal alert has been sent')),
                ('inspection_alert_sent', models.BooleanField(default=False, help_text='Whether inspection alert has been sent')),
                ('previous_license_number', models.CharField(blank=True, help_text='Previous license number (if renewed)', max_length=100)),
                ('license_history', models.JSONField(default=list, help_text='History of license changes')),
                ('violations_history', models.JSONField(default=list, help_text='History of violations or issues')),
                ('is_transferable', models.BooleanField(default=False, help_text='Whether license can be transferred')),
                ('requires_medical_director', models.BooleanField(default=False, help_text='Whether license requires a medical director')),
                ('medical_director_required', models.CharField(blank=True, help_text='Medical director information', max_length=200)),
                ('is_active', models.BooleanField(default=True, help_text='Whether license record is active')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the license')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_hospital_licenses', to=settings.AUTH_USER_MODEL)),
                ('healthcare_authority', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='issued_licenses', to='api.healthcareauthority')),
                ('hospital', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='licenses', to='api.hospital')),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='modified_hospital_licenses', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-expiration_date', 'license_type'],
                'permissions': [('can_manage_licenses', 'Can manage hospital licenses'), ('can_view_license_details', 'Can view license details'), ('can_verify_licenses', 'Can verify license status'), ('can_upload_documents', 'Can upload license documents')],
            },
        ),
        migrations.CreateModel(
            name='InsuranceProvider',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Official name of the insurance provider', max_length=200, unique=True)),
                ('short_name', models.CharField(blank=True, help_text='Common abbreviation or short name', max_length=50)),
                ('provider_code', models.CharField(blank=True, help_text='Unique identifier code for the provider', max_length=20, unique=True)),
                ('headquarters_address', models.TextField()),
                ('phone_number', models.CharField(max_length=20)),
                ('email', models.EmailField(max_length=254)),
                ('website', models.URLField(blank=True)),
                ('customer_service_phone', models.CharField(blank=True, help_text='Customer service hotline', max_length=20)),
                ('provider_portal_url', models.URLField(blank=True, help_text='URL for provider portal if available')),
                ('coverage_area', models.CharField(choices=[('national', 'National Coverage'), ('regional', 'Regional Coverage'), ('state', 'State/Province Coverage'), ('local', 'Local Coverage'), ('international', 'International Coverage')], default='national', max_length=20)),
                ('network_tier', models.CharField(choices=[('tier_1', 'Tier 1 (Premium)'), ('tier_2', 'Tier 2 (Standard)'), ('tier_3', 'Tier 3 (Basic)'), ('government', 'Government Insurance'), ('private', 'Private Insurance')], default='private', max_length=20)),
                ('countries_served', models.JSONField(default=list, help_text='List of countries where coverage is available')),
                ('regions_served', models.JSONField(default=list, help_text='List of regions/states served')),
                ('integration_type', models.CharField(choices=[('api', 'API Integration'), ('portal', 'Web Portal Integration'), ('manual', 'Manual Verification'), ('edi', 'Electronic Data Interchange'), ('hybrid', 'Multiple Methods')], default='manual', max_length=20)),
                ('api_base_url', models.URLField(blank=True, help_text='Base URL for API integration')),
                ('api_version', models.CharField(blank=True, help_text='API version (e.g., v1, v2)', max_length=10)),
                ('api_documentation_url', models.URLField(blank=True, help_text='URL to API documentation')),
                ('requires_authentication', models.BooleanField(default=True, help_text='Whether API requires authentication')),
                ('authentication_type', models.CharField(blank=True, help_text='Type of authentication (Bearer, API Key, OAuth, etc.)', max_length=50)),
                ('test_credentials_available', models.BooleanField(default=False, help_text='Whether test/sandbox credentials are available')),
                ('average_response_time', models.PositiveIntegerField(blank=True, help_text='Average API response time in milliseconds', null=True)),
                ('uptime_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='API uptime percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('rate_limit', models.PositiveIntegerField(blank=True, help_text='API rate limit per minute', null=True)),
                ('is_active', models.BooleanField(default=True, help_text='Whether the provider is currently active')),
                ('accepts_new_providers', models.BooleanField(default=True, help_text='Whether they accept new healthcare providers')),
                ('minimum_volume_requirement', models.PositiveIntegerField(blank=True, help_text='Minimum monthly claims volume required', null=True)),
                ('contract_terms', models.TextField(blank=True, help_text='General contract terms and requirements')),
                ('typical_reimbursement_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Typical reimbursement percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('payment_terms_days', models.PositiveIntegerField(blank=True, help_text='Typical payment terms in days', null=True)),
                ('processing_fee_percentage', models.DecimalField(blank=True, decimal_places=4, help_text='Processing fee percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)])),
                ('_encrypted_api_credentials', models.BinaryField(blank=True, help_text='Encrypted API credentials', null=True)),
                ('integration_notes', models.TextField(blank=True, help_text='Notes about integration setup and requirements')),
                ('last_verified', models.DateTimeField(blank=True, help_text='Last time provider information was verified', null=True)),
                ('verification_frequency_days', models.PositiveIntegerField(default=30, help_text='How often to verify provider information')),
                ('data_quality_score', models.PositiveIntegerField(blank=True, help_text='Data quality score based on accuracy and completeness', null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('hipaa_compliant', models.BooleanField(default=False, help_text='Whether provider is HIPAA compliant')),
                ('soc2_certified', models.BooleanField(default=False, help_text='Whether provider has SOC 2 certification')),
                ('iso27001_certified', models.BooleanField(default=False, help_text='Whether provider has ISO 27001 certification')),
                ('compliance_notes', models.TextField(blank=True, help_text='Additional compliance information')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_insurance_providers', to=settings.AUTH_USER_MODEL)),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='modified_insurance_providers', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['name'],
                'permissions': [('can_view_api_credentials', 'Can view API credentials'), ('can_modify_integration_settings', 'Can modify integration settings'), ('can_verify_provider_data', 'Can verify provider data')],
            },
        ),
        migrations.CreateModel(
            name='HospitalInsuranceProvider',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contract_number', models.CharField(blank=True, help_text="Hospital's contract number with insurance provider", max_length=100)),
                ('provider_id', models.CharField(help_text="Hospital's provider ID with this insurance company", max_length=50)),
                ('network_type', models.CharField(choices=[('in_network', 'In-Network Provider'), ('out_of_network', 'Out-of-Network Provider'), ('preferred', 'Preferred Provider'), ('exclusive', 'Exclusive Provider')], default='in_network', max_length=20)),
                ('contract_status', models.CharField(choices=[('active', 'Active Contract'), ('pending', 'Pending Approval'), ('suspended', 'Suspended'), ('terminated', 'Terminated'), ('expired', 'Expired')], default='active', max_length=20)),
                ('contract_start_date', models.DateField()),
                ('contract_end_date', models.DateField(blank=True, help_text='Leave blank for indefinite contracts', null=True)),
                ('last_renewal_date', models.DateField(blank=True, null=True)),
                ('next_renewal_due', models.DateField(blank=True, null=True)),
                ('base_reimbursement_rate', models.DecimalField(decimal_places=2, help_text='Base reimbursement percentage', max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('emergency_reimbursement_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Emergency services reimbursement percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('specialist_reimbursement_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Specialist consultation reimbursement percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('standard_copay_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Standard copay amount for consultations', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('specialist_copay_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Copay amount for specialist consultations', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('emergency_copay_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Emergency services copay amount', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('annual_deductible', models.DecimalField(blank=True, decimal_places=2, help_text='Annual deductible amount', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('visit_limit_per_year', models.PositiveIntegerField(blank=True, help_text='Maximum visits per year (0 for unlimited)', null=True)),
                ('max_coverage_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Maximum coverage amount per year', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('covered_services', models.JSONField(default=list, help_text='List of covered services/specialties')),
                ('excluded_services', models.JSONField(default=list, help_text='List of excluded services/treatments')),
                ('requires_referral', models.JSONField(default=list, help_text='Services that require referral')),
                ('requires_preauthorization', models.JSONField(default=list, help_text='Services requiring pre-authorization')),
                ('claims_submission_method', models.CharField(choices=[('electronic', 'Electronic Submission'), ('paper', 'Paper Submission'), ('portal', 'Insurance Portal'), ('edi', 'EDI Submission'), ('api', 'API Integration')], default='electronic', max_length=20)),
                ('claims_contact_email', models.EmailField(blank=True, help_text='Email for claims submission', max_length=254)),
                ('claims_contact_phone', models.CharField(blank=True, help_text='Phone for claims inquiries', max_length=20)),
                ('claims_portal_url', models.URLField(blank=True, help_text='URL for claims submission portal')),
                ('average_claims_processing_days', models.PositiveIntegerField(blank=True, help_text='Average days to process claims', null=True)),
                ('claims_approval_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Percentage of claims approved', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('average_payment_days', models.PositiveIntegerField(blank=True, help_text='Average days to receive payment', null=True)),
                ('primary_contact_name', models.CharField(blank=True, help_text='Primary contact person at insurance company', max_length=100)),
                ('primary_contact_email', models.EmailField(blank=True, help_text='Primary contact email', max_length=254)),
                ('primary_contact_phone', models.CharField(blank=True, help_text='Primary contact phone', max_length=20)),
                ('requires_credentialing', models.BooleanField(default=True, help_text='Whether doctors need to be credentialed individually')),
                ('credentialing_in_progress', models.BooleanField(default=False, help_text='Whether credentialing is currently in progress')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the relationship')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this relationship is currently active')),
                ('contract_renewal_alert_sent', models.BooleanField(default=False, help_text='Whether renewal alert has been sent')),
                ('last_verification_date', models.DateField(blank=True, help_text='Last time contract details were verified', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_hospital_insurance_relationships', to=settings.AUTH_USER_MODEL)),
                ('hospital', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='insurance_relationships', to='api.hospital')),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='modified_hospital_insurance_relationships', to=settings.AUTH_USER_MODEL)),
                ('insurance_provider', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='hospital_relationships', to='api.insuranceprovider')),
            ],
            options={
                'ordering': ['hospital__name', 'insurance_provider__name'],
                'permissions': [('can_manage_insurance_contracts', 'Can manage insurance contracts'), ('can_view_financial_terms', 'Can view financial terms'), ('can_update_performance_metrics', 'Can update performance metrics')],
            },
        ),
        migrations.CreateModel(
            name='PatientInsurancePolicy',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('policy_number', models.CharField(help_text='Insurance policy number', max_length=100)),
                ('group_number', models.CharField(blank=True, help_text='Group policy number (for employer insurance)', max_length=100)),
                ('member_id', models.CharField(help_text='Member/subscriber ID', max_length=100)),
                ('subscriber_name', models.CharField(help_text='Name of the primary subscriber', max_length=200)),
                ('relationship_to_subscriber', models.CharField(choices=[('self', 'Self'), ('spouse', 'Spouse'), ('child', 'Child'), ('parent', 'Parent'), ('dependent', 'Dependent'), ('other', 'Other')], default='self', max_length=20)),
                ('is_primary_insurance', models.BooleanField(default=True, help_text='Whether this is the primary insurance')),
                ('priority_order', models.PositiveIntegerField(default=1, help_text='Priority order for multiple insurance policies')),
                ('policy_effective_date', models.DateField()),
                ('policy_expiration_date', models.DateField(blank=True, help_text='Leave blank for policies without expiration', null=True)),
                ('coverage_start_date', models.DateField(help_text='When coverage starts for this patient')),
                ('coverage_end_date', models.DateField(blank=True, help_text='When coverage ends for this patient', null=True)),
                ('annual_deductible', models.DecimalField(blank=True, decimal_places=2, help_text='Annual deductible amount', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('deductible_met_amount', models.DecimalField(decimal_places=2, default=0, help_text='Amount of deductible already met this year', max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('out_of_pocket_maximum', models.DecimalField(blank=True, decimal_places=2, help_text='Annual out-of-pocket maximum', max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('out_of_pocket_met_amount', models.DecimalField(decimal_places=2, default=0, help_text='Amount of out-of-pocket maximum already met', max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('coverage_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='General coverage percentage', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MinValueValidator(100)])),
                ('copay_primary_care', models.DecimalField(blank=True, decimal_places=2, help_text='Copay for primary care visits', max_digits=8, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('copay_specialist', models.DecimalField(blank=True, decimal_places=2, help_text='Copay for specialist visits', max_digits=8, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('copay_emergency', models.DecimalField(blank=True, decimal_places=2, help_text='Copay for emergency room visits', max_digits=8, null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('verification_status', models.CharField(choices=[('verified', 'Verified'), ('pending', 'Pending Verification'), ('failed', 'Verification Failed'), ('expired', 'Verification Expired'), ('not_verified', 'Not Verified')], default='not_verified', max_length=20)),
                ('last_verification_date', models.DateTimeField(blank=True, help_text='Last time eligibility was verified', null=True)),
                ('verification_frequency_days', models.PositiveIntegerField(default=30, help_text='How often to verify eligibility')),
                ('_encrypted_verification_data', models.BinaryField(blank=True, help_text='Encrypted verification response data', null=True)),
                ('requires_referral_for_specialists', models.BooleanField(default=False, help_text='Whether specialist visits require referrals')),
                ('requires_preauthorization', models.JSONField(default=list, help_text='Services requiring pre-authorization')),
                ('covered_services', models.JSONField(default=list, help_text='List of covered services')),
                ('excluded_services', models.JSONField(default=list, help_text='List of excluded services')),
                ('member_services_phone', models.CharField(blank=True, help_text='Insurance company member services phone', max_length=20)),
                ('claims_address', models.TextField(blank=True, help_text='Address for mailing claims')),
                ('employer_name', models.CharField(blank=True, help_text='Employer name (for employer-sponsored insurance)', max_length=200)),
                ('plan_name', models.CharField(blank=True, help_text='Specific plan name', max_length=200)),
                ('plan_type', models.CharField(blank=True, help_text='Type of plan (HMO, PPO, EPO, etc.)', max_length=50)),
                ('policy_status', models.CharField(choices=[('active', 'Active'), ('inactive', 'Inactive'), ('suspended', 'Suspended'), ('terminated', 'Terminated'), ('pending', 'Pending Activation')], default='active', max_length=20)),
                ('is_active', models.BooleanField(default=True, help_text='Whether this policy is currently active')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the policy')),
                ('insurance_card_front', models.FileField(blank=True, help_text='Front of insurance card', null=True, upload_to='insurance_cards/front/')),
                ('insurance_card_back', models.FileField(blank=True, help_text='Back of insurance card', null=True, upload_to='insurance_cards/back/')),
                ('benefits_summary', models.FileField(blank=True, help_text='Benefits summary document', null=True, upload_to='insurance_documents/benefits/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_patient_policies', to=settings.AUTH_USER_MODEL)),
                ('insurance_provider', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='patient_policies', to='api.insuranceprovider')),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='modified_patient_policies', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='insurance_policies', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name_plural': 'Patient Insurance Policies',
                'ordering': ['priority_order', '-created_at'],
                'permissions': [('can_view_insurance_details', 'Can view insurance details'), ('can_verify_eligibility', 'Can verify insurance eligibility'), ('can_update_verification', 'Can update verification status')],
            },
        ),
        migrations.CreateModel(
            name='InsuranceVerificationTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('task_id', models.CharField(help_text='Unique task identifier', max_length=50, unique=True)),
                ('verification_type', models.CharField(choices=[('eligibility', 'Eligibility Verification'), ('benefits', 'Benefits Verification'), ('preauth', 'Pre-authorization'), ('claims_status', 'Claims Status Check'), ('provider_enrollment', 'Provider Enrollment Verification'), ('policy_update', 'Policy Information Update')], default='eligibility', max_length=30)),
                ('due_date', models.DateTimeField(help_text='When this task should be completed')),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=10)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled'), ('requires_follow_up', 'Requires Follow-up')], default='pending', max_length=20)),
                ('verification_method', models.CharField(choices=[('api', 'API Integration'), ('portal', 'Insurance Portal'), ('phone', 'Phone Call'), ('fax', 'Fax Verification'), ('email', 'Email Verification'), ('manual', 'Manual Process'), ('hybrid', 'Multiple Methods')], default='manual', max_length=20)),
                ('attempts_count', models.PositiveIntegerField(default=0, help_text='Number of verification attempts made')),
                ('max_attempts', models.PositiveIntegerField(default=3, help_text='Maximum number of attempts before escalation')),
                ('verification_purpose', models.TextField(blank=True, help_text='Purpose or reason for verification')),
                ('service_details', models.JSONField(default=dict, help_text='Details about services being verified')),
                ('special_instructions', models.TextField(blank=True, help_text='Special instructions for verification')),
                ('insurance_contact_name', models.CharField(blank=True, help_text='Name of insurance contact person', max_length=100)),
                ('insurance_contact_phone', models.CharField(blank=True, help_text='Phone number for verification', max_length=20)),
                ('insurance_contact_email', models.EmailField(blank=True, help_text='Email for verification', max_length=254)),
                ('reference_number', models.CharField(blank=True, help_text='Reference number from insurance company', max_length=100)),
                ('verification_result', models.JSONField(default=dict, help_text='Structured verification results')),
                ('verification_notes', models.TextField(blank=True, help_text='Detailed notes from verification process')),
                ('verification_documents', models.JSONField(default=list, help_text='List of documents uploaded during verification')),
                ('_encrypted_verification_response', models.BinaryField(blank=True, help_text='Encrypted raw verification response', null=True)),
                ('follow_up_required', models.BooleanField(default=False, help_text='Whether follow-up is required')),
                ('follow_up_date', models.DateTimeField(blank=True, help_text='When to follow up', null=True)),
                ('escalation_reason', models.TextField(blank=True, help_text='Reason for escalation')),
                ('started_at', models.DateTimeField(blank=True, help_text='When verification was started', null=True)),
                ('completed_at', models.DateTimeField(blank=True, help_text='When verification was completed', null=True)),
                ('total_time_spent', models.PositiveIntegerField(blank=True, help_text='Total time spent in minutes', null=True)),
                ('api_call_log', models.JSONField(default=list, help_text='Log of API calls made for this verification')),
                ('automation_attempted', models.BooleanField(default=False, help_text='Whether automation was attempted first')),
                ('automation_failure_reason', models.TextField(blank=True, help_text='Why automation failed (if applicable)')),
                ('quality_score', models.PositiveIntegerField(blank=True, help_text='Quality score (1-10) for verification', null=True)),
                ('quality_notes', models.TextField(blank=True, help_text='Quality review notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, help_text='Staff member assigned to this task', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_verification_tasks', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(help_text='User who created this task', on_delete=django.db.models.deletion.PROTECT, related_name='created_verification_tasks', to=settings.AUTH_USER_MODEL)),
                ('escalated_to', models.ForeignKey(blank=True, help_text='User task was escalated to', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='escalated_verification_tasks', to=settings.AUTH_USER_MODEL)),
                ('reviewed_by', models.ForeignKey(blank=True, help_text='Supervisor who reviewed this task', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_verification_tasks', to=settings.AUTH_USER_MODEL)),
                ('patient_policy', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='verification_tasks', to='api.patientinsurancepolicy')),
            ],
            options={
                'ordering': ['-priority', 'due_date', '-created_at'],
                'permissions': [('can_assign_verification_tasks', 'Can assign verification tasks'), ('can_view_verification_results', 'Can view verification results'), ('can_escalate_tasks', 'Can escalate verification tasks'), ('can_review_quality', 'Can review verification quality')],
            },
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['name'], name='api_healthc_name_767f50_idx'),
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['authority_code'], name='api_healthc_authori_8ee854_idx'),
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['country'], name='api_healthc_country_ad9240_idx'),
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['authority_type'], name='api_healthc_authori_0d738f_idx'),
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['jurisdiction_level'], name='api_healthc_jurisdi_26f24d_idx'),
        ),
        migrations.AddIndex(
            model_name='healthcareauthority',
            index=models.Index(fields=['is_active'], name='api_healthc_is_acti_c8283e_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['hospital', 'license_status'], name='api_hospita_hospita_0d4892_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['license_number'], name='api_hospita_license_97de82_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['license_type'], name='api_hospita_license_c29b40_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['expiration_date'], name='api_hospita_expirat_2a686a_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['next_renewal_due'], name='api_hospita_next_re_e35108_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['next_inspection_due'], name='api_hospita_next_in_bb6e26_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitallicense',
            index=models.Index(fields=['healthcare_authority'], name='api_hospita_healthc_b32c9a_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='hospitallicense',
            unique_together={('hospital', 'license_number', 'healthcare_authority')},
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['name'], name='api_insuran_name_e53558_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['provider_code'], name='api_insuran_provide_2ab50c_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['coverage_area'], name='api_insuran_coverag_b236bb_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['network_tier'], name='api_insuran_network_186738_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['integration_type'], name='api_insuran_integra_48c45e_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceprovider',
            index=models.Index(fields=['is_active'], name='api_insuran_is_acti_69dc19_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitalinsuranceprovider',
            index=models.Index(fields=['hospital', 'contract_status'], name='api_hospita_hospita_c32666_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitalinsuranceprovider',
            index=models.Index(fields=['insurance_provider', 'network_type'], name='api_hospita_insuran_2dc286_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitalinsuranceprovider',
            index=models.Index(fields=['contract_end_date'], name='api_hospita_contrac_8e7980_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitalinsuranceprovider',
            index=models.Index(fields=['next_renewal_due'], name='api_hospita_next_re_03835c_idx'),
        ),
        migrations.AddIndex(
            model_name='hospitalinsuranceprovider',
            index=models.Index(fields=['is_active'], name='api_hospita_is_acti_4e7617_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='hospitalinsuranceprovider',
            unique_together={('hospital', 'insurance_provider')},
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['patient', 'is_primary_insurance'], name='api_patient_patient_a80f2e_idx'),
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['policy_number'], name='api_patient_policy__20f4f0_idx'),
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['member_id'], name='api_patient_member__183800_idx'),
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['verification_status'], name='api_patient_verific_55e144_idx'),
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['policy_status'], name='api_patient_policy__b11192_idx'),
        ),
        migrations.AddIndex(
            model_name='patientinsurancepolicy',
            index=models.Index(fields=['last_verification_date'], name='api_patient_last_ve_7e42c4_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='patientinsurancepolicy',
            unique_together={('patient', 'insurance_provider', 'policy_number')},
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['task_id'], name='api_insuran_task_id_5ec9cf_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['status', 'priority'], name='api_insuran_status_229949_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['assigned_to', 'status'], name='api_insuran_assigne_fcc673_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['due_date'], name='api_insuran_due_dat_4cf882_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['verification_type'], name='api_insuran_verific_cec50d_idx'),
        ),
        migrations.AddIndex(
            model_name='insuranceverificationtask',
            index=models.Index(fields=['patient_policy'], name='api_insuran_patient_029d23_idx'),
        ),
    ]
