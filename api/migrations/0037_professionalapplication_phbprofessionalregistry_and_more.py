# Generated by Django 5.0.1 on 2025-11-02 00:18

import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('api', '0036_prescriptionrequest_assigned_to_doctor_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='ProfessionalApplication',
            fields=[
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier for the application', primary_key=True, serialize=False)),
                ('application_reference', models.CharField(db_index=True, help_text='Human-readable reference (e.g., PHB-APP-2025-00123)', max_length=30, unique=True)),
                ('professional_type', models.CharField(choices=[('doctor', 'Medical Doctor'), ('pharmacist', 'Pharmacist'), ('nurse', 'Nurse'), ('physiotherapist', 'Physiotherapist'), ('lab_technician', 'Laboratory Technician'), ('radiographer', 'Radiographer'), ('midwife', 'Midwife'), ('dentist', 'Dentist'), ('optometrist', 'Optometrist')], db_index=True, help_text='Type of professional applying (doctor, pharmacist, etc.)', max_length=30)),
                ('title', models.CharField(choices=[('Dr', 'Dr.'), ('Mr', 'Mr.'), ('Mrs', 'Mrs.'), ('Ms', 'Ms.'), ('Prof', 'Prof.')], help_text='Professional title', max_length=10)),
                ('first_name', models.CharField(max_length=100)),
                ('middle_name', models.CharField(blank=True, max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('date_of_birth', models.DateField(help_text='Date of birth')),
                ('gender', models.CharField(choices=[('male', 'Male'), ('female', 'Female'), ('other', 'Other'), ('prefer_not_to_say', 'Prefer not to say')], max_length=20)),
                ('nationality', models.CharField(help_text='Nationality (e.g., Nigerian, British, etc.)', max_length=100)),
                ('email', models.EmailField(help_text='Primary email address', max_length=254)),
                ('phone', models.CharField(help_text='Primary phone number', max_length=20)),
                ('alternate_phone', models.CharField(blank=True, max_length=20)),
                ('address_line_1', models.CharField(max_length=255)),
                ('address_line_2', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(max_length=100)),
                ('state', models.CharField(max_length=100)),
                ('postcode', models.CharField(max_length=10)),
                ('country', models.CharField(default='Nigeria', max_length=100)),
                ('primary_qualification', models.CharField(help_text='Primary degree (e.g., MBBS, BPharm, etc.)', max_length=255)),
                ('qualification_institution', models.CharField(help_text='Institution where primary qualification was obtained', max_length=255)),
                ('qualification_year', models.PositiveIntegerField(help_text='Year of qualification')),
                ('qualification_country', models.CharField(help_text='Country of qualification', max_length=100)),
                ('additional_qualifications', models.JSONField(blank=True, default=list, help_text='Array of additional qualifications [{degree, institution, year}, ...]')),
                ('specialization', models.CharField(choices=[('general_practice', 'General Practice'), ('internal_medicine', 'Internal Medicine'), ('surgery', 'Surgery'), ('pediatrics', 'Pediatrics'), ('obstetrics_gynecology', 'Obstetrics & Gynecology'), ('cardiology', 'Cardiology'), ('neurology', 'Neurology'), ('psychiatry', 'Psychiatry'), ('oncology', 'Oncology'), ('emergency_medicine', 'Emergency Medicine'), ('radiology', 'Radiology'), ('anesthesiology', 'Anesthesiology'), ('community_pharmacy', 'Community Pharmacy'), ('hospital_pharmacy', 'Hospital Pharmacy'), ('clinical_pharmacy', 'Clinical Pharmacy'), ('oncology_pharmacy', 'Oncology Pharmacy'), ('pediatric_pharmacy', 'Pediatric Pharmacy'), ('general_nursing', 'General Nursing'), ('critical_care_nursing', 'Critical Care Nursing'), ('pediatric_nursing', 'Pediatric Nursing'), ('psychiatric_nursing', 'Psychiatric Nursing'), ('oncology_nursing', 'Oncology Nursing'), ('other', 'Other (Specify in Notes)')], help_text='Area of specialization', max_length=50)),
                ('subspecialization', models.CharField(blank=True, help_text='Sub-specialization if applicable', max_length=100)),
                ('home_registration_body', models.CharField(blank=True, help_text='Registration body in home country (e.g., GMC, MDCN, etc.)', max_length=255)),
                ('home_registration_number', models.CharField(blank=True, help_text='Registration number with home registration body', max_length=100)),
                ('home_registration_date', models.DateField(blank=True, help_text='Date of home registration', null=True)),
                ('employment_history', models.JSONField(blank=True, default=list, help_text='Previous employment [{employer, position, from_date, to_date, responsibilities}, ...]')),
                ('years_of_experience', models.PositiveIntegerField(default=0, help_text='Total years of professional experience')),
                ('status', models.CharField(choices=[('draft', 'Draft - Incomplete'), ('submitted', 'Submitted - Pending Review'), ('under_review', 'Under Review'), ('documents_requested', 'Additional Documents Requested'), ('payment_pending', 'Payment Pending'), ('payment_confirmed', 'Payment Confirmed'), ('verification_in_progress', 'Verification In Progress'), ('approved', 'Approved - License Issued'), ('rejected', 'Rejected'), ('expired', 'Expired')], db_index=True, default='draft', help_text='Current status of the application', max_length=30)),
                ('submitted_date', models.DateTimeField(blank=True, help_text='When the application was submitted', null=True)),
                ('under_review_date', models.DateTimeField(blank=True, help_text='When review started', null=True)),
                ('decision_date', models.DateTimeField(blank=True, help_text='When decision was made (approved/rejected)', null=True)),
                ('review_notes', models.TextField(blank=True, help_text='Internal review notes from admin')),
                ('rejection_reason', models.TextField(blank=True, help_text='Reason for rejection (if rejected)')),
                ('application_fee', models.DecimalField(decimal_places=2, default=0.0, help_text='Application fee amount (e.g., â‚¦50,000)', max_digits=10)),
                ('payment_reference', models.CharField(blank=True, help_text='Paystack payment reference', max_length=100)),
                ('payment_status', models.CharField(choices=[('pending', 'Pending'), ('paid', 'Paid'), ('failed', 'Failed'), ('refunded', 'Refunded')], default='pending', max_length=20)),
                ('payment_date', models.DateTimeField(blank=True, help_text='When payment was confirmed', null=True)),
                ('phb_license_number', models.CharField(blank=True, db_index=True, help_text='PHB professional license number (e.g., PHB-DOC-2025-00123)', max_length=50, null=True, unique=True)),
                ('license_issue_date', models.DateField(blank=True, help_text='Date license was issued', null=True)),
                ('license_expiry_date', models.DateField(blank=True, help_text='License expiry date (typically 1 year from issue)', null=True)),
                ('documents_verified', models.BooleanField(default=False, help_text='Whether all required documents have been verified')),
                ('identity_verified', models.BooleanField(default=False, help_text='Whether identity has been verified')),
                ('qualifications_verified', models.BooleanField(default=False, help_text='Whether qualifications have been verified')),
                ('registration_verified', models.BooleanField(default=False, help_text='Whether professional registration has been verified')),
                ('reason_for_application', models.TextField(blank=True, help_text='Why applying for PHB registration')),
                ('practice_intentions', models.TextField(blank=True, help_text='Intended practice settings (hospital, private, both, etc.)')),
                ('languages_spoken', models.CharField(blank=True, help_text='Languages spoken (comma-separated)', max_length=255)),
                ('agreed_to_terms', models.BooleanField(default=False, help_text='Applicant agreed to terms and conditions')),
                ('agreed_to_code_of_conduct', models.BooleanField(default=False, help_text='Applicant agreed to professional code of conduct')),
                ('declaration_truthful', models.BooleanField(default=False, help_text='Applicant declared all information is truthful')),
                ('reviewed_by', models.ForeignKey(blank=True, help_text='Admin user who reviewed the application', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_applications', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(help_text='User account submitting the application', on_delete=django.db.models.deletion.CASCADE, related_name='professional_applications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Professional Application',
                'verbose_name_plural': 'Professional Applications',
                'db_table': 'professional_applications',
                'ordering': ['-submitted_date', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PHBProfessionalRegistry',
            fields=[
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier for registry entry', primary_key=True, serialize=False)),
                ('phb_license_number', models.CharField(db_index=True, help_text='PHB professional license number (e.g., PHB-DOC-2025-00123)', max_length=50, unique=True)),
                ('professional_type', models.CharField(choices=[('doctor', 'Medical Doctor'), ('pharmacist', 'Pharmacist'), ('nurse', 'Nurse'), ('physiotherapist', 'Physiotherapist'), ('lab_technician', 'Laboratory Technician'), ('radiographer', 'Radiographer'), ('midwife', 'Midwife'), ('dentist', 'Dentist'), ('optometrist', 'Optometrist')], db_index=True, help_text='Type of professional', max_length=30)),
                ('title', models.CharField(help_text='Professional title (Dr., Mr., etc.)', max_length=10)),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('primary_qualification', models.CharField(help_text='Primary degree (e.g., MBBS, BPharm, etc.)', max_length=255)),
                ('qualification_year', models.PositiveIntegerField(help_text='Year of qualification')),
                ('specialization', models.CharField(blank=True, db_index=True, help_text='Area of specialization', max_length=100)),
                ('license_status', models.CharField(choices=[('active', 'Active - Licensed to Practice'), ('suspended', 'Suspended'), ('expired', 'Expired - Renewal Required'), ('revoked', 'Revoked'), ('inactive', 'Inactive - Voluntarily Not Practicing')], db_index=True, default='active', help_text='Current status of the professional license', max_length=20)),
                ('license_issue_date', models.DateField(help_text='Date license was first issued')),
                ('license_expiry_date', models.DateField(help_text='Current license expiry date (requires annual renewal)')),
                ('last_renewal_date', models.DateField(blank=True, help_text='Last license renewal date', null=True)),
                ('home_registration_body', models.CharField(blank=True, help_text='Primary registration body (e.g., GMC, MDCN, etc.)', max_length=255)),
                ('home_registration_number', models.CharField(blank=True, help_text='Registration number with primary body', max_length=100)),
                ('practice_type', models.CharField(choices=[('hospital', 'Hospital-based Only'), ('private', 'Private Practice Only'), ('both', 'Both Hospital and Private'), ('not_practicing', 'Not Currently Practicing')], default='hospital', help_text='Current practice setting', max_length=30)),
                ('city', models.CharField(db_index=True, help_text='City where professional is based', max_length=100)),
                ('state', models.CharField(db_index=True, help_text='State/region', max_length=100)),
                ('country', models.CharField(default='Nigeria', max_length=100)),
                ('languages_spoken', models.CharField(blank=True, help_text='Languages spoken (comma-separated)', max_length=255)),
                ('public_email', models.EmailField(blank=True, help_text='Public email for professional inquiries (optional)', max_length=254)),
                ('public_phone', models.CharField(blank=True, help_text='Public phone number (optional)', max_length=20)),
                ('website', models.URLField(blank=True, help_text='Professional website (optional)')),
                ('identity_verified', models.BooleanField(default=True, help_text='Identity has been verified by PHB')),
                ('qualifications_verified', models.BooleanField(default=True, help_text='Qualifications verified by PHB')),
                ('has_disciplinary_record', models.BooleanField(default=False, help_text='Whether professional has any disciplinary sanctions')),
                ('disciplinary_notes', models.TextField(blank=True, help_text='Public record of any sanctions or restrictions (if applicable)')),
                ('status_changed_date', models.DateField(blank=True, help_text='Last date status was changed (suspension, revocation, etc.)', null=True)),
                ('status_change_reason', models.TextField(blank=True, help_text='Reason for status change (if applicable)')),
                ('is_searchable', models.BooleanField(default=True, help_text='Whether this entry appears in public registry search')),
                ('biography', models.TextField(blank=True, help_text='Optional professional biography (public)')),
                ('areas_of_interest', models.TextField(blank=True, help_text='Clinical interests or areas of expertise (public)')),
                ('first_registered_date', models.DateField(auto_now_add=True, help_text='Date first added to PHB registry')),
                ('user', models.OneToOneField(help_text='User account linked to this professional', on_delete=django.db.models.deletion.CASCADE, related_name='professional_registry', to=settings.AUTH_USER_MODEL)),
                ('application', models.OneToOneField(help_text='Approved application that created this registry entry', on_delete=django.db.models.deletion.CASCADE, related_name='registry_entry', to='api.professionalapplication')),
            ],
            options={
                'verbose_name': 'PHB Professional Registry Entry',
                'verbose_name_plural': 'PHB Professional Registry Entries',
                'db_table': 'phb_professional_registry',
                'ordering': ['last_name', 'first_name'],
            },
        ),
        migrations.CreateModel(
            name='ApplicationDocument',
            fields=[
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier for the document', primary_key=True, serialize=False)),
                ('document_type', models.CharField(choices=[('passport', 'Passport'), ('national_id', 'National ID Card'), ('drivers_license', "Driver's License"), ('primary_degree_certificate', 'Primary Degree Certificate'), ('postgraduate_certificate', 'Postgraduate Certificate'), ('fellowship_certificate', 'Fellowship Certificate'), ('transcript', 'Academic Transcript'), ('home_registration_certificate', 'Home Country Registration Certificate'), ('practicing_license', 'Current Practicing License'), ('good_standing_certificate', 'Certificate of Good Standing'), ('cv_resume', 'CV/Resume'), ('passport_photo', 'Passport Photograph'), ('proof_of_address', 'Proof of Address'), ('character_reference', 'Character Reference Letter'), ('employment_letter', 'Employment Verification Letter'), ('internship_certificate', 'Internship/House Job Certificate'), ('specialty_certificate', 'Specialty Board Certification'), ('malpractice_insurance', 'Malpractice Insurance Certificate'), ('criminal_record_check', 'Criminal Record Check'), ('other', 'Other Document')], db_index=True, help_text='Type of document', max_length=50)),
                ('document_title', models.CharField(help_text='Title/name of the document', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Optional description or notes about the document')),
                ('file', models.FileField(help_text='Uploaded document file (PDF, JPG, PNG)', upload_to='professional_applications/%Y/%m/')),
                ('file_size', models.PositiveIntegerField(blank=True, help_text='File size in bytes', null=True)),
                ('file_type', models.CharField(blank=True, help_text='MIME type of the file', max_length=50)),
                ('original_filename', models.CharField(blank=True, help_text='Original filename when uploaded', max_length=255)),
                ('verification_status', models.CharField(choices=[('pending', 'Pending Verification'), ('under_review', 'Under Review'), ('verified', 'Verified'), ('rejected', 'Rejected - Invalid'), ('clarification_needed', 'Clarification Needed')], db_index=True, default='pending', help_text='Verification status of the document', max_length=30)),
                ('verified_date', models.DateTimeField(blank=True, help_text='When the document was verified', null=True)),
                ('verification_notes', models.TextField(blank=True, help_text='Notes from the verifier')),
                ('issue_date', models.DateField(blank=True, help_text='Date document was issued (if applicable)', null=True)),
                ('expiry_date', models.DateField(blank=True, help_text='Expiry date (if applicable, e.g., for licenses)', null=True)),
                ('issuing_authority', models.CharField(blank=True, help_text='Organization that issued the document (e.g., university, GMC, etc.)', max_length=255)),
                ('document_number', models.CharField(blank=True, help_text='Document/certificate number (if applicable)', max_length=100)),
                ('is_required', models.BooleanField(default=True, help_text='Whether this document is required for application approval')),
                ('uploaded_by', models.ForeignKey(help_text='User who uploaded the document', on_delete=django.db.models.deletion.CASCADE, related_name='uploaded_documents', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, help_text='Admin user who verified the document', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_documents', to=settings.AUTH_USER_MODEL)),
                ('application', models.ForeignKey(help_text='Professional application this document belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='api.professionalapplication')),
            ],
            options={
                'verbose_name': 'Application Document',
                'verbose_name_plural': 'Application Documents',
                'db_table': 'application_documents',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='professionalapplication',
            index=models.Index(fields=['status', '-submitted_date'], name='idx_app_status_date'),
        ),
        migrations.AddIndex(
            model_name='professionalapplication',
            index=models.Index(fields=['professional_type', 'status'], name='idx_app_type_status'),
        ),
        migrations.AddIndex(
            model_name='professionalapplication',
            index=models.Index(fields=['user', '-created_at'], name='idx_app_user_date'),
        ),
        migrations.AddIndex(
            model_name='professionalapplication',
            index=models.Index(fields=['phb_license_number'], name='idx_app_license'),
        ),
        migrations.AddIndex(
            model_name='professionalapplication',
            index=models.Index(fields=['application_reference'], name='idx_app_ref'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['phb_license_number'], name='idx_reg_license'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['professional_type', 'license_status'], name='idx_reg_type_status'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['license_status', 'license_expiry_date'], name='idx_reg_status_expiry'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['specialization', 'license_status'], name='idx_reg_spec_status'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['city', 'state'], name='idx_reg_location'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['last_name', 'first_name'], name='idx_reg_name'),
        ),
        migrations.AddIndex(
            model_name='phbprofessionalregistry',
            index=models.Index(fields=['is_searchable', 'license_status'], name='idx_reg_searchable'),
        ),
        migrations.AddIndex(
            model_name='applicationdocument',
            index=models.Index(fields=['application', 'document_type'], name='idx_doc_app_type'),
        ),
        migrations.AddIndex(
            model_name='applicationdocument',
            index=models.Index(fields=['verification_status', '-created_at'], name='idx_doc_status'),
        ),
        migrations.AddIndex(
            model_name='applicationdocument',
            index=models.Index(fields=['application', 'verification_status'], name='idx_doc_app_status'),
        ),
    ]
